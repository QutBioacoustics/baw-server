- content_for :meta_title, "Projects #{@user.user_name} can access"
- content_for(:page_title) do
  Projects
  %small
    accessible by
    = image_tag @user.image.url(:spanhalf), alt: @user.user_name
    = @user.user_name

= render partial: 'shared/sidebar_user'

%p
  You can
  = link_to 'request access', new_access_request_projects_path
  to existing projects or
  = link_to 'create', new_project_path
  your own projects.

- if @user_projects.empty?
  No projects to show.
- else
  = page_entries_info @user_projects
  = will_paginate @user_projects, renderer: BawWillPaginateLinkRenderer

  %table.table.table-striped.table-hover
    %thead
      %tr
        %th
          %i.fa.fa-home
          Project
        %th
          %i.fa.fa-map-marker
          Sites
        %th
          %i.fa.fa-key
          Permission

    %tbody
    - @user_projects.each do |project|
      %tr
        %td= link_to project.name, project_path(project)
        %td= project.sites.size
        %td
          - actual_level = Access::Query.level_project(@user, project)
          - level_name = Access::Core.get_level_name(actual_level)
          - if Access::Check.allowed?(:writer, actual_level)
            = link_to level_name, project_permissions_path(project)
          - else
            = level_name